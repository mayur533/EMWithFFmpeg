========================================
WHITE POSTERS ISSUE - DIAGNOSTIC GUIDE
========================================

If posters are showing as white/blank screens, this guide will help you
identify whether it's a BACKEND or FRONTEND issue.

================================================
STEP 1: CHECK CONSOLE LOGS
================================================

Open your app and check the console for these specific logs:

üîç LOOK FOR: Image URL Information
----------------------------------

You should see logs like this:

üìã Poster Details:
  1. ID: poster-123
     Title: Wedding Decoration Poster
     Category: Decorators
     Premium: No
     üñºÔ∏è THUMBNAIL: https://example.com/images/poster-123.jpg
     üñºÔ∏è IMAGE URL: https://example.com/images/poster-123-full.jpg
     üì• DOWNLOAD URL: https://example.com/downloads/poster-123.jpg
     ---

================================================
DIAGNOSIS SCENARIOS
================================================

SCENARIO A: URLs are MISSING or NULL
------------------------------------
Console shows:
  üñºÔ∏è THUMBNAIL: ‚ö†Ô∏è MISSING/NULL
  üñºÔ∏è IMAGE URL: ‚ö†Ô∏è MISSING/NULL

ALSO shows:
  üö® IMAGE URL ISSUE DETECTED:
     3 poster(s) have missing image URLs!
     Poster IDs with missing images: [...]
     ‚ö†Ô∏è This is likely a BACKEND ISSUE

**DIAGNOSIS:** üî¥ BACKEND ISSUE
**REASON:** Backend is not returning image URLs
**SOLUTION:** See "Backend Fix Section" below


SCENARIO B: URLs exist but images fail to load
----------------------------------------------
Console shows:
  üñºÔ∏è THUMBNAIL: https://example.com/images/poster-123.jpg
  ‚úÖ IMAGE URL CHECK: All posters have valid image URLs

BUT ALSO shows:
  ‚ùå Image load error for poster: poster-123
     Thumbnail URL: https://example.com/images/poster-123.jpg
     Error: [error message]

**DIAGNOSIS:** üü° BACKEND or NETWORK ISSUE
**POSSIBLE REASONS:**
  1. Image URLs point to non-existent files
  2. CORS issues (web app)
  3. Wrong domain/path in URLs
  4. Images not uploaded to server
  5. File permissions issue
**SOLUTION:** See "Backend Image Hosting Section" below


SCENARIO C: URLs exist and valid but still white
------------------------------------------------
Console shows:
  üñºÔ∏è THUMBNAIL: https://example.com/images/poster-123.jpg
  ‚úÖ IMAGE URL CHECK: All posters have valid image URLs
  üé® Rendering poster 1: { id: '...', thumbnail: 'https://...', hasValidUrl: true }
  ‚úÖ Image loaded successfully for poster: poster-123

BUT images still appear white

**DIAGNOSIS:** üîµ FRONTEND STYLING ISSUE
**POSSIBLE REASONS:**
  1. Image style has opacity: 0
  2. Image is behind other elements (z-index)
  3. Image dimensions are 0
  4. backgroundColor covering image
**SOLUTION:** See "Frontend Fix Section" below


SCENARIO D: Invalid URL format
------------------------------
Console shows:
  üñºÔ∏è THUMBNAIL: /uploads/poster-123.jpg (relative path)
  OR
  üñºÔ∏è THUMBNAIL: poster-123.jpg (no path at all)

And shows:
  üé® Rendering poster 1: { hasValidUrl: false }

**DIAGNOSIS:** üî¥ BACKEND ISSUE - Invalid URL format
**REASON:** Backend returning relative paths instead of absolute URLs
**SOLUTION:** Backend must return full URLs like:
  https://yourdomain.com/uploads/poster-123.jpg


================================================
BACKEND FIX SECTION
================================================

FIX 1: Backend Not Returning Image URLs
---------------------------------------

Problem: Backend returns poster data without image URLs

Check your backend endpoint:
  GET /api/mobile/posters/category/{category}

Expected response format:
```json
{
  "success": true,
  "data": {
    "posters": [
      {
        "id": "poster-1",
        "title": "Wedding Decoration Poster",
        "category": "Decorators",
        "thumbnail": "https://yourdomain.com/uploads/thumbnails/poster-1.jpg",
        "imageUrl": "https://yourdomain.com/uploads/images/poster-1.jpg",
        "downloadUrl": "https://yourdomain.com/uploads/downloads/poster-1.jpg",
        "likes": 0,
        "downloads": 0,
        "isPremium": false,
        "tags": ["wedding", "decoration"],
        "createdAt": "2024-01-01T00:00:00.000Z",
        "updatedAt": "2024-01-01T00:00:00.000Z"
      }
    ]
  }
}
```

‚úÖ Make sure your backend:
  1. Has actual image files uploaded
  2. Stores image URLs in database (thumbnail, imageUrl, downloadUrl)
  3. Returns complete URLs (not relative paths)
  4. Uses accessible domain/server


FIX 2: Images Not Uploaded to Server
------------------------------------

Problem: URLs exist but point to non-existent files

Steps to fix:
1. Check if image files exist on server:
   - SSH to server: ssh user@yourserver.com
   - Check uploads folder: ls -la /path/to/uploads/
   - Verify files exist: ls -la /path/to/uploads/poster-1.jpg

2. If files don't exist, upload them:
   - Via admin panel upload feature
   - Via FTP/SCP: scp poster-1.jpg user@server:/path/to/uploads/
   - Via backend API: POST /api/admin/posters/upload

3. Verify file permissions:
   - Files should be readable: chmod 644 /path/to/uploads/*.jpg
   - Directory should be accessible: chmod 755 /path/to/uploads/


FIX 3: Wrong Domain in URLs
---------------------------

Problem: URLs use wrong domain (localhost, old domain, etc.)

Example of WRONG URLs:
  ‚ùå http://localhost:3001/uploads/poster-1.jpg
  ‚ùå http://192.168.1.100/uploads/poster-1.jpg
  ‚ùå http://olddomain.com/uploads/poster-1.jpg

Example of CORRECT URLs:
  ‚úÖ https://eventmarketersbackend.onrender.com/uploads/poster-1.jpg
  ‚úÖ https://yourdomain.com/uploads/poster-1.jpg
  ‚úÖ https://cdn.yourdomain.com/posters/poster-1.jpg

Fix in backend code:
```javascript
// Bad - relative path
const thumbnail = `/uploads/${filename}`;

// Good - absolute URL
const baseUrl = process.env.BASE_URL || 'https://yourdomain.com';
const thumbnail = `${baseUrl}/uploads/${filename}`;
```


FIX 4: CORS Issues (Web App Only)
---------------------------------

Problem: Images blocked by CORS policy

Solution - Add CORS headers in backend:
```javascript
// In your backend server (Express.js example)
app.use((req, res, next) => {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept');
  next();
});

// OR use cors package
const cors = require('cors');
app.use(cors());
```


FIX 5: Using Cloud Storage (Recommended)
----------------------------------------

For production, store images on cloud storage:

Option A: AWS S3
```javascript
const imageUrl = `https://your-bucket.s3.amazonaws.com/posters/${filename}`;
```

Option B: Cloudinary
```javascript
const imageUrl = cloudinary.url(publicId, {
  width: 800,
  height: 600,
  crop: 'fill'
});
```

Option C: Google Cloud Storage
```javascript
const imageUrl = `https://storage.googleapis.com/your-bucket/posters/${filename}`;
```


================================================
FRONTEND FIX SECTION
================================================

FIX 1: Check Image Component Props
----------------------------------

Current code (MyBusinessScreen.tsx line 291-304):
```typescript
<Image 
  source={{ uri: item.thumbnail }} 
  style={styles.posterImage}
  onError={(error) => {
    console.error('‚ùå Image load error for poster:', item.id);
  }}
  onLoad={() => {
    console.log('‚úÖ Image loaded successfully');
  }}
/>
```

If images show white, verify:
1. source prop has valid { uri: 'http://...' } format
2. style has proper width/height
3. No overlaying elements covering image


FIX 2: Check Image Styles
-------------------------

Look for these styling issues:

```typescript
// BAD - image has no dimensions
posterImage: {
  width: '100%',
  height: '100%', // Might be 0 if parent has no height
}

// GOOD - explicit dimensions
posterImage: {
  width: '100%',
  height: '100%',
  minHeight: 150, // Fallback height
}

// BAD - hidden image
posterImage: {
  opacity: 0, // ‚ùå Makes image invisible
  display: 'none', // ‚ùå Hides image
}

// BAD - covered by background
posterCard: {
  backgroundColor: 'white', // ‚ùå Covering image
  position: 'relative',
}
posterImage: {
  position: 'absolute', // Behind the white background
}
```


FIX 3: Add Fallback/Placeholder Image
-------------------------------------

```typescript
<Image 
  source={{ uri: item.thumbnail }} 
  style={styles.posterImage}
  defaultSource={require('../assets/placeholder.jpg')} // Fallback
/>
```


FIX 4: Use Fast Image Library (Better performance)
--------------------------------------------------

```bash
npm install react-native-fast-image
```

```typescript
import FastImage from 'react-native-fast-image';

<FastImage
  source={{
    uri: item.thumbnail,
    priority: FastImage.priority.normal,
  }}
  style={styles.posterImage}
  resizeMode={FastImage.resizeMode.cover}
/>
```


================================================
TESTING CHECKLIST
================================================

Backend Testing:
‚ñ° Run: curl https://yourbackend.com/api/mobile/posters/category/Decorators
‚ñ° Verify response includes thumbnail, imageUrl, downloadUrl
‚ñ° Copy thumbnail URL and open in browser
‚ñ° Verify image loads in browser
‚ñ° Check if URL is absolute (starts with http:// or https://)
‚ñ° Verify files exist on server

Frontend Testing:
‚ñ° Check console for "üö® IMAGE URL ISSUE DETECTED"
‚ñ° Check console for "‚ùå Image load error"
‚ñ° Check console for "‚úÖ Image loaded successfully"
‚ñ° Verify hasValidUrl: true in rendering logs
‚ñ° Check if other images in app work (to rule out general issue)
‚ñ° Try using a known working image URL to test Image component

Network Testing:
‚ñ° Check device has internet connection
‚ñ° Try loading image URL in phone browser
‚ñ° Check if VPN/proxy is blocking requests
‚ñ° Verify no firewall blocking image requests


================================================
QUICK TEST - TEMPORARY FIX
================================================

To quickly test if it's a backend issue, temporarily use a
known working image URL:

```typescript
<Image 
  source={{ 
    uri: item.thumbnail || 'https://via.placeholder.com/300x200' 
  }} 
  style={styles.posterImage}
/>
```

If placeholder images show but real images don't:
  ‚Üí BACKEND ISSUE (URLs are wrong/broken)

If even placeholder doesn't show:
  ‚Üí FRONTEND ISSUE (Image component or styling problem)


================================================
FINAL DIAGNOSIS COMMAND
================================================

Run these console commands after opening My Business screen:

1. Check if URLs exist:
   Look for: "‚úÖ IMAGE URL CHECK" or "üö® IMAGE URL ISSUE DETECTED"

2. Check render logs:
   Look for: "üé® Rendering poster" with hasValidUrl: true/false

3. Check load status:
   Look for: "‚úÖ Image loaded successfully" or "‚ùå Image load error"

Based on what you see:
- No URLs ‚Üí Backend not returning URLs
- URLs but load error ‚Üí Backend hosting issue / wrong URLs
- URLs and load success but white ‚Üí Frontend styling issue
- Invalid URLs (hasValidUrl: false) ‚Üí Backend returning relative paths

================================================
MOST COMMON CAUSE
================================================

üéØ In 90% of cases, white posters mean:

1. Backend is returning empty/null image URLs
2. Backend is returning relative paths instead of absolute URLs
3. Image files don't exist on the server

Check your console logs for the exact issue!

================================================
END OF DIAGNOSTIC GUIDE
================================================

